---
categories: ["算法"]
tags: ["雪花算法"]
title: "雪花算法"
# linkTitle: ""
weight: 10
description: >

---



# 简介

雪花算法：由Twitter开源的分布式ID生成算法。主要应用于分库分表场景中的全局ID作为业务主键，或者生成全局唯一的订单号。

名称由来：一般的雪花大约由10的19次方哥水分子组成。在雪花的形成过程中，会形成不同的结构分支，大自然中并不存在两片完全一样的雪花，每一片雪花都会有其自己独特的形状。雪花算法的意思就是表示生成的ID如雪花一般独一无二。

解决唯一ID一般方法：

* UUID
* 系统时间戳
* Redis原子递增
* 全局表自增ID

分布式ID除了唯一性，还需要满足以下特征：

* 单调递增
>保证下一个ID号一定大于上一个

* 保证安全（无规则性）
>ID号需要无规则性，不能让别人根据ID号推测出信息和业务数据量，增加恶意用户爬取数据的难度

* 含时间戳
>ID需要记录系统时间戳

* 高可用
>获取分布式ID的请求，服务至少要保证99.999%的情况下给创建一个全局唯一的分布式ID

* 低延迟
>获取分布式ID的请求要快、延迟低

* 高QPS
>服务器要支撑并且成功创建10万个分布式ID

# 实现原理

0 - 00000000 00000000 000000000 00000000 0 - 00000000 00 - 00000000 0000

组成部分：

* 符号位 （1bit）
* 时间戳（41bit）
* 机器码（10bit）
* 序列号（12bit）
# 优缺点

## 优点

* 分布式系统内不会产生ID碰撞，效率高
* 不需要依赖数据库等第三方系统，稳定性更高，可以根据自身业务分配bit位，非常灵活
* 生成ID性能非常高，每秒能生成26万个自增可排序的ID
## 缺点

* 如果机器回拨，肯能导致ID重复
* 分布式环境，每台机器上的时钟不可能完全同步，有时候会出现不是全局递增的情况
